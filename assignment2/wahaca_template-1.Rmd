---
title: "Wacaha"
subtitle: "Pricing and Retail Analytics"
author: "Natalie Kvochak, Maryclare Leonard, Sean O'Grady"
date: "3/29/31"
output:
  pdf_document:
    number_sections: yes
colorlinks: true
urlcolor: 'red'
fontsize: 12pt
header-includes: \usepackage{color,soul}
---

```{r, include=FALSE}
# We recommend including this entire code chunk at the top of all 
# your R Markdown files. 'include=FALSE' omits this code in the output
# but R still runs it.

# Load libraries needed for analysis
library(knitr)                 # Creating PDF output using Markdown
library(tidyverse)             # Data manipulation and graphing
library(readxl)                # To use read_excel()
library(psych)                 # To use corr.test() for correlation matrices
theme_set(theme_bw())          # Get rid of gray background in plots

# Set some defaults for the R Markdown document
opts_chunk$set(echo=TRUE,      # Print the code in all the chunks
               warning=FALSE,  # Don't print warning statements
               message=FALSE,  # Don't print other R output messages
               comment=NA)     # Helps produce prettier output
```

# Technical section

This is where your technical material should go. You might start by reading in the data.

## Data setup
```{r}
# Read in the data
df <- read_excel("small_salsa.xlsx")

# Create logged prices and quantities
df <- df %>% 
  mutate(ln_p = log(price),
         ln_q = log(units),
         Dholiday = factor(holiday),
         Dstore = factor(store),
         Dzone= factor(zone))

```

## Data Exploration
```{r}
#plot price versus units
plot(df$price, df$units,main="Units as a function of price",xlab="Price",ylab="Units",pch=19)

plot(df$ln_q,df$ln_p,main="Log price as a function of log units",xlab="Log Units",ylab="Log Price",pch=19)
```

## Correlation
```{r}
corr.test(df %>% select(price, pop, units, holiday))
```

## Regression
```{r}
reg1 <- lm(ln_q ~ ln_p + Dzone + Dholiday, data=df)
summary(reg1)
```

The regression indicates that the price elasticity is for the historical data is `r round(reg1$coefficients['ln_p'],3)`.

## Regression No Holiday 
```{r}
reg.noholiday <- lm(ln_q ~ ln_p + Dstore, data=df %>% filter(Dholiday==0))
summary(reg.noholiday)
```

The regression indicates that the price elasticity is for the historical data is `r round(reg.noholiday$coefficients['ln_p'],3)`. This is a minor change to our original regression's price elasticity.

You could keep adding lines of code to the chunk above, or start a new chunk with additional analysis below.

```{r}
# More code here

```

# Managerial Discussion

Managerial discussion goes here.
